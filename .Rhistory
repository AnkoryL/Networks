if (!file.exists(config_path)) {
stop("main_config.txt not found at: ", config_path)
}
message("[2/10] Reading configuration from file...")
config <- read_config_txt(config_path)
if (missing(genes_list_path))    genes_list_path    <- config$genes_list_path
if (missing(species_prefix))     species_prefix     <- config$species_prefix
if (missing(go_type))            go_type            <- config$go_type
if (missing(output_folder_path)) output_folder_path <- config$output_folder_path
if (missing(connection_type))    connection_type    <- config$connection_type
if (missing(level_from))         level_from         <- config$level_from
if (missing(level_to))           level_to           <- config$level_to
if (missing(label_type))         label_type         <- config$label_type
if (missing(layout_name))        layout_name        <- config$layout
if (missing(threshold))          threshold          <- config$threshold
if (is.null(config_evidence_path) || config_evidence_path == "") {
config_evidence_path <- default_evidence_experimental_only()
}
} else {
message("[2/10] Using provided arguments...")
}
go_file_path <- get_go_file_by_prefix(species_prefix, go_type)
message("[3/10] Logging parameters to output folder...")
log_lines <- c(
sprintf("   Species: %s", species_prefix),
sprintf("   GO file path: %s", go_file_path),
sprintf("   Genes list path: %s", genes_list_path),
sprintf("   Config evidence path: %s", config_evidence_path),
sprintf("   Output folder path: %s", normalizePath(output_folder_path, winslash = "/", mustWork = FALSE)),
sprintf("   Connection type: %s", connection_type),
sprintf("   GO level range: %s to %s", level_from, level_to),
sprintf("   Label type: %s", label_type),
sprintf("   Threshold weight: %s", threshold),
sprintf("   Layout option: %s", layout_name)
)
log_file <- file.path(output_folder_path, "log_parameters.txt")
writeLines(log_lines, con = log_file)
message("[4/10] Reading gene list...")
gene_df <- prepare_genes(genes_list_path, species_prefix, output_folder_path)
print(gene_df)
message("[5/10] Reading GO annotation file...")
go_df <- read_go_annotations(go_file_path, species_prefix)
print(go_df)
message("[6/10] Annotating genes with GO terms...")
annotated_genes <- annotate_with_go_terms(gene_df, go_df, output_folder_path, species_prefix)
print(annotated_genes)
message("[7/10] Checking annotation coverage...")
coverage_stats <- check_annotation_coverage(
annotated_genes = annotated_genes,
genes_list = unique(gene_df$ENSEMBL),
output_path = file.path(output_folder_path, "term_gene_table_not_mapped.txt")
)
message(sprintf("Total genes: %d, Unmapped genes: %d", coverage_stats$total, coverage_stats$unmapped))
message("[8/10] Filtering GO terms by evidence and level...")
filtered_data <- filter_go_annotations(annotated_genes, config_evidence_path, level_from, level_to)
print(filtered_data)
message("[9/10] Building network...")
network <- build_network(
filtered_data = filtered_data,
gene_df = gene_df,
label_type = label_type,
layout_name = layout_name,
threshold = threshold,
output_folder_path = output_folder_path,
connection_type = connection_type
)
message("[10/10] Results saved.")
message("Pipeline completed successfully!\n → Output folder: ", output_folder_path)
devtools::load_all()
# zebrafish, GO: IP, id: ensembl_symbol, format: csv:
# zebrafish, GO: IP, id: ensembl, format: csv:
#  Error - All input genes are unmapped: 7/7.
# Running pipeline for zebrafish, GO: IP, format: csv, id: symbol:
# Total genes: 8, Unmapped genes: 5
# genes_list_path = system.file("extdata/example/zebrafish_ensembl_symbol.csv", package = "Networks")
genes_list_path = system.file("extdata/example/zebrafish_symbol.csv", package = "Networks")
species_prefix = "zebrafish"
go_type = "IP"
output_folder_path = "C:/Users/Ankory/YandexDisk/is_not_a_wolf/Networks/inst/extdata/example/result"
config_path = NULL
config_evidence_path = system.file("extdata/example/example_config_evidence.txt", package = "Networks")
connection_type = "common_go_term"
level_from = 5
level_to = 20
label_type = "SYMBOL"
layout_name = "layout_nicely"
threshold = 5
message("[1/10] Starting pipeline...")
if (!is.null(config_path)) {
if (!file.exists(config_path)) {
stop("main_config.txt not found at: ", config_path)
}
message("[2/10] Reading configuration from file...")
config <- read_config_txt(config_path)
if (missing(genes_list_path))    genes_list_path    <- config$genes_list_path
if (missing(species_prefix))     species_prefix     <- config$species_prefix
if (missing(go_type))            go_type            <- config$go_type
if (missing(output_folder_path)) output_folder_path <- config$output_folder_path
if (missing(connection_type))    connection_type    <- config$connection_type
if (missing(level_from))         level_from         <- config$level_from
if (missing(level_to))           level_to           <- config$level_to
if (missing(label_type))         label_type         <- config$label_type
if (missing(layout_name))        layout_name        <- config$layout
if (missing(threshold))          threshold          <- config$threshold
if (is.null(config_evidence_path) || config_evidence_path == "") {
config_evidence_path <- default_evidence_experimental_only()
}
} else {
message("[2/10] Using provided arguments...")
}
go_file_path <- get_go_file_by_prefix(species_prefix, go_type)
message("[3/10] Logging parameters to output folder...")
log_lines <- c(
sprintf("   Species: %s", species_prefix),
sprintf("   GO file path: %s", go_file_path),
sprintf("   Genes list path: %s", genes_list_path),
sprintf("   Config evidence path: %s", config_evidence_path),
sprintf("   Output folder path: %s", normalizePath(output_folder_path, winslash = "/", mustWork = FALSE)),
sprintf("   Connection type: %s", connection_type),
sprintf("   GO level range: %s to %s", level_from, level_to),
sprintf("   Label type: %s", label_type),
sprintf("   Threshold weight: %s", threshold),
sprintf("   Layout option: %s", layout_name)
)
log_file <- file.path(output_folder_path, "log_parameters.txt")
writeLines(log_lines, con = log_file)
message("[4/10] Reading gene list...")
gene_df <- prepare_genes(genes_list_path, species_prefix, output_folder_path)
print(gene_df)
message("[5/10] Reading GO annotation file...")
go_df <- read_go_annotations(go_file_path, species_prefix)
print(go_df)
message("[6/10] Annotating genes with GO terms...")
annotated_genes <- annotate_with_go_terms(gene_df, go_df, output_folder_path, species_prefix)
print(annotated_genes)
message("[7/10] Checking annotation coverage...")
coverage_stats <- check_annotation_coverage(
annotated_genes = annotated_genes,
genes_list = unique(gene_df$ENSEMBL),
output_path = file.path(output_folder_path, "term_gene_table_not_mapped.txt")
)
message(sprintf("Total genes: %d, Unmapped genes: %d", coverage_stats$total, coverage_stats$unmapped))
message("[8/10] Filtering GO terms by evidence and level...")
filtered_data <- filter_go_annotations(annotated_genes, config_evidence_path, level_from, level_to)
print(filtered_data)
message("[9/10] Building network...")
network <- build_network(
filtered_data = filtered_data,
gene_df = gene_df,
label_type = label_type,
layout_name = layout_name,
threshold = threshold,
output_folder_path = output_folder_path,
connection_type = connection_type
)
message("[10/10] Results saved.")
message("Pipeline completed successfully!\n → Output folder: ", output_folder_path)
# zebrafish, GO: IP, id: ensembl_symbol, format: csv:
# zebrafish, GO: IP, id: ensembl, format: csv:
#  Error - All input genes are unmapped: 7/7.
# Running pipeline for zebrafish, GO: IP, format: csv, id: symbol:
# Total genes: 8, Unmapped genes: 5
# genes_list_path = system.file("extdata/example/zebrafish_ensembl_symbol.csv", package = "Networks")
genes_list_path = system.file("extdata/example/zebrafish_symbol.csv", package = "Networks")
species_prefix = "zebrafish"
go_type = "IP"
output_folder_path = "C:/Users/Ankory/YandexDisk/is_not_a_wolf/Networks/inst/extdata/example/result"
config_path = NULL
config_evidence_path = system.file("extdata/example/example_config_evidence.txt", package = "Networks")
connection_type = "common_go_term"
level_from = 5
level_to = 20
label_type = "SYMBOL"
layout_name = "layout_nicely"
threshold = 5
message("[1/10] Starting pipeline...")
if (!is.null(config_path)) {
if (!file.exists(config_path)) {
stop("main_config.txt not found at: ", config_path)
}
message("[2/10] Reading configuration from file...")
config <- read_config_txt(config_path)
if (missing(genes_list_path))    genes_list_path    <- config$genes_list_path
if (missing(species_prefix))     species_prefix     <- config$species_prefix
if (missing(go_type))            go_type            <- config$go_type
if (missing(output_folder_path)) output_folder_path <- config$output_folder_path
if (missing(connection_type))    connection_type    <- config$connection_type
if (missing(level_from))         level_from         <- config$level_from
if (missing(level_to))           level_to           <- config$level_to
if (missing(label_type))         label_type         <- config$label_type
if (missing(layout_name))        layout_name        <- config$layout
if (missing(threshold))          threshold          <- config$threshold
if (is.null(config_evidence_path) || config_evidence_path == "") {
config_evidence_path <- default_evidence_experimental_only()
}
} else {
message("[2/10] Using provided arguments...")
}
go_file_path <- get_go_file_by_prefix(species_prefix, go_type)
message("[3/10] Logging parameters to output folder...")
log_lines <- c(
sprintf("   Species: %s", species_prefix),
sprintf("   GO file path: %s", go_file_path),
sprintf("   Genes list path: %s", genes_list_path),
sprintf("   Config evidence path: %s", config_evidence_path),
sprintf("   Output folder path: %s", normalizePath(output_folder_path, winslash = "/", mustWork = FALSE)),
sprintf("   Connection type: %s", connection_type),
sprintf("   GO level range: %s to %s", level_from, level_to),
sprintf("   Label type: %s", label_type),
sprintf("   Threshold weight: %s", threshold),
sprintf("   Layout option: %s", layout_name)
)
log_file <- file.path(output_folder_path, "log_parameters.txt")
writeLines(log_lines, con = log_file)
message("[4/10] Reading gene list...")
gene_df <- prepare_genes(genes_list_path, species_prefix, output_folder_path)
print(gene_df)
message("[5/10] Reading GO annotation file...")
go_df <- read_go_annotations(go_file_path, species_prefix)
print(go_df)
message("[6/10] Annotating genes with GO terms...")
annotated_genes <- annotate_with_go_terms(gene_df, go_df, output_folder_path, species_prefix)
print(annotated_genes)
message("[7/10] Checking annotation coverage...")
coverage_stats <- check_annotation_coverage(
annotated_genes = annotated_genes,
genes_list = unique(gene_df$ENSEMBL),
output_path = file.path(output_folder_path, "term_gene_table_not_mapped.txt")
)
print(annotated_genes)
print(unique(gene_df$ENSEMBL))
message(sprintf("Total genes: %d, Unmapped genes: %d", coverage_stats$total, coverage_stats$unmapped))
message("[8/10] Filtering GO terms by evidence and level...")
filtered_data <- filter_go_annotations(annotated_genes, config_evidence_path, level_from, level_to)
print(filtered_data)
message("[9/10] Building network...")
network <- build_network(
filtered_data = filtered_data,
gene_df = gene_df,
label_type = label_type,
layout_name = layout_name,
threshold = threshold,
output_folder_path = output_folder_path,
connection_type = connection_type
)
message("[10/10] Results saved.")
message("Pipeline completed successfully!\n → Output folder: ", output_folder_path)
devtools::load_all()
test_file("C:/Users/Ankory/YandexDisk/is_not_a_wolf/Networks/tests/testthat/test-Run_Pipeline.R", reporter = "progress")
devtools::load_all()
test_file("C:/Users/Ankory/YandexDisk/is_not_a_wolf/Networks/tests/testthat/test-Run_Pipeline.R", reporter = "progress")
devtools::load_all()
test_file("C:/Users/Ankory/YandexDisk/is_not_a_wolf/Networks/tests/testthat/test-Run_Pipeline.R", reporter = "progress")
# zebrafish, GO: IP, id: ensembl_symbol, format: csv:
# zebrafish, GO: IP, id: ensembl, format: csv:
#  Error - All input genes are unmapped: 7/7.
# Running pipeline for zebrafish, GO: IP, format: csv, id: symbol:
# Total genes: 8, Unmapped genes: 5
# genes_list_path = system.file("extdata/example/zebrafish_ensembl_symbol.csv", package = "Networks")
genes_list_path = system.file("extdata/example/zebrafish_symbol.csv", package = "Networks")
species_prefix = "zebrafish"
go_type = "IP"
output_folder_path = "C:/Users/Ankory/YandexDisk/is_not_a_wolf/Networks/inst/extdata/example/result"
config_path = NULL
config_evidence_path = system.file("extdata/example/example_config_evidence.txt", package = "Networks")
connection_type = "common_go_term"
level_from = 5
level_to = 20
label_type = "SYMBOL"
layout_name = "layout_nicely"
threshold = 5
message("[1/10] Starting pipeline...")
if (!is.null(config_path)) {
if (!file.exists(config_path)) {
stop("main_config.txt not found at: ", config_path)
}
message("[2/10] Reading configuration from file...")
config <- read_config_txt(config_path)
if (missing(genes_list_path))    genes_list_path    <- config$genes_list_path
if (missing(species_prefix))     species_prefix     <- config$species_prefix
if (missing(go_type))            go_type            <- config$go_type
if (missing(output_folder_path)) output_folder_path <- config$output_folder_path
if (missing(connection_type))    connection_type    <- config$connection_type
if (missing(level_from))         level_from         <- config$level_from
if (missing(level_to))           level_to           <- config$level_to
if (missing(label_type))         label_type         <- config$label_type
if (missing(layout_name))        layout_name        <- config$layout
if (missing(threshold))          threshold          <- config$threshold
if (is.null(config_evidence_path) || config_evidence_path == "") {
config_evidence_path <- default_evidence_experimental_only()
}
} else {
message("[2/10] Using provided arguments...")
}
go_file_path <- get_go_file_by_prefix(species_prefix, go_type)
message("[3/10] Logging parameters to output folder...")
log_lines <- c(
sprintf("   Species: %s", species_prefix),
sprintf("   GO file path: %s", go_file_path),
sprintf("   Genes list path: %s", genes_list_path),
sprintf("   Config evidence path: %s", config_evidence_path),
sprintf("   Output folder path: %s", normalizePath(output_folder_path, winslash = "/", mustWork = FALSE)),
sprintf("   Connection type: %s", connection_type),
sprintf("   GO level range: %s to %s", level_from, level_to),
sprintf("   Label type: %s", label_type),
sprintf("   Threshold weight: %s", threshold),
sprintf("   Layout option: %s", layout_name)
)
log_file <- file.path(output_folder_path, "log_parameters.txt")
writeLines(log_lines, con = log_file)
message("[4/10] Reading gene list...")
gene_df <- prepare_genes(genes_list_path, species_prefix, output_folder_path)
print(gene_df)
message("[5/10] Reading GO annotation file...")
go_df <- read_go_annotations(go_file_path, species_prefix)
print(go_df)
message("[6/10] Annotating genes with GO terms...")
annotated_genes <- annotate_with_go_terms(gene_df, go_df, output_folder_path, species_prefix)
print(annotated_genes)
message("[7/10] Checking annotation coverage...")
coverage_stats <- check_annotation_coverage(
annotated_genes = annotated_genes,
genes_list = unique(gene_df$ENSEMBL),
output_path = file.path(output_folder_path, "term_gene_table_not_mapped.txt")
)
print(annotated_genes)
print(unique(gene_df$ENSEMBL))
message(sprintf("Total genes: %d, Unmapped genes: %d", coverage_stats$total, coverage_stats$unmapped))
message("[8/10] Filtering GO terms by evidence and level...")
filtered_data <- filter_go_annotations(annotated_genes, config_evidence_path, level_from, level_to)
print(filtered_data)
message("[9/10] Building network...")
network <- build_network(
filtered_data = filtered_data,
gene_df = gene_df,
label_type = label_type,
layout_name = layout_name,
threshold = threshold,
output_folder_path = output_folder_path,
connection_type = connection_type
)
message("[10/10] Results saved.")
message("Pipeline completed successfully!\n → Output folder: ", output_folder_path)
# zebrafish, GO: IP, id: ensembl_symbol, format: csv:
# zebrafish, GO: IP, id: ensembl, format: csv:
#  Error - All input genes are unmapped: 7/7.
# Running pipeline for zebrafish, GO: IP, format: csv, id: symbol:
# Total genes: 8, Unmapped genes: 5
genes_list_path = system.file("extdata/example/zebrafish_ensembl_symbol.csv", package = "Networks")
# genes_list_path = system.file("extdata/example/zebrafish_symbol.csv", package = "Networks")
species_prefix = "zebrafish"
go_type = "IP"
output_folder_path = "C:/Users/Ankory/YandexDisk/is_not_a_wolf/Networks/inst/extdata/example/result"
config_path = NULL
config_evidence_path = system.file("extdata/example/example_config_evidence.txt", package = "Networks")
connection_type = "common_go_term"
level_from = 5
level_to = 20
label_type = "SYMBOL"
layout_name = "layout_nicely"
threshold = 5
message("[1/10] Starting pipeline...")
if (!is.null(config_path)) {
if (!file.exists(config_path)) {
stop("main_config.txt not found at: ", config_path)
}
message("[2/10] Reading configuration from file...")
config <- read_config_txt(config_path)
if (missing(genes_list_path))    genes_list_path    <- config$genes_list_path
if (missing(species_prefix))     species_prefix     <- config$species_prefix
if (missing(go_type))            go_type            <- config$go_type
if (missing(output_folder_path)) output_folder_path <- config$output_folder_path
if (missing(connection_type))    connection_type    <- config$connection_type
if (missing(level_from))         level_from         <- config$level_from
if (missing(level_to))           level_to           <- config$level_to
if (missing(label_type))         label_type         <- config$label_type
if (missing(layout_name))        layout_name        <- config$layout
if (missing(threshold))          threshold          <- config$threshold
if (is.null(config_evidence_path) || config_evidence_path == "") {
config_evidence_path <- default_evidence_experimental_only()
}
} else {
message("[2/10] Using provided arguments...")
}
go_file_path <- get_go_file_by_prefix(species_prefix, go_type)
message("[3/10] Logging parameters to output folder...")
log_lines <- c(
sprintf("   Species: %s", species_prefix),
sprintf("   GO file path: %s", go_file_path),
sprintf("   Genes list path: %s", genes_list_path),
sprintf("   Config evidence path: %s", config_evidence_path),
sprintf("   Output folder path: %s", normalizePath(output_folder_path, winslash = "/", mustWork = FALSE)),
sprintf("   Connection type: %s", connection_type),
sprintf("   GO level range: %s to %s", level_from, level_to),
sprintf("   Label type: %s", label_type),
sprintf("   Threshold weight: %s", threshold),
sprintf("   Layout option: %s", layout_name)
)
log_file <- file.path(output_folder_path, "log_parameters.txt")
writeLines(log_lines, con = log_file)
message("[4/10] Reading gene list...")
gene_df <- prepare_genes(genes_list_path, species_prefix, output_folder_path)
print(gene_df)
message("[5/10] Reading GO annotation file...")
go_df <- read_go_annotations(go_file_path, species_prefix)
print(go_df)
message("[6/10] Annotating genes with GO terms...")
annotated_genes <- annotate_with_go_terms(gene_df, go_df, output_folder_path, species_prefix)
print(annotated_genes)
message("[7/10] Checking annotation coverage...")
coverage_stats <- check_annotation_coverage(
annotated_genes = annotated_genes,
genes_list = unique(gene_df$ENSEMBL),
output_path = file.path(output_folder_path, "term_gene_table_not_mapped.txt")
)
print(annotated_genes)
print(unique(gene_df$ENSEMBL))
message(sprintf("Total genes: %d, Unmapped genes: %d", coverage_stats$total, coverage_stats$unmapped))
message("[8/10] Filtering GO terms by evidence and level...")
filtered_data <- filter_go_annotations(annotated_genes, config_evidence_path, level_from, level_to)
print(filtered_data)
message("[9/10] Building network...")
network <- build_network(
filtered_data = filtered_data,
gene_df = gene_df,
label_type = label_type,
layout_name = layout_name,
threshold = threshold,
output_folder_path = output_folder_path,
connection_type = connection_type
)
# zebrafish, GO: IP, id: ensembl_symbol, format: csv:
# zebrafish, GO: IP, id: ensembl, format: csv:
#  Error - All input genes are unmapped: 7/7.
# Running pipeline for zebrafish, GO: IP, format: csv, id: symbol:
# Total genes: 8, Unmapped genes: 5
genes_list_path = system.file("extdata/example/zebrafish_ensembl_symbol.csv", package = "Networks")
# genes_list_path = system.file("extdata/example/zebrafish_symbol.csv", package = "Networks")
species_prefix = "zebrafish"
go_type = "IP"
output_folder_path = "C:/Users/Ankory/YandexDisk/is_not_a_wolf/Networks/inst/extdata/example/result"
config_path = NULL
config_evidence_path = system.file("extdata/example/example_config_evidence.txt", package = "Networks")
connection_type = "common_go_term"
level_from = 5
level_to = 20
label_type = "SYMBOL"
layout_name = "layout_nicely"
threshold = 5
message("[1/10] Starting pipeline...")
if (!is.null(config_path)) {
if (!file.exists(config_path)) {
stop("main_config.txt not found at: ", config_path)
}
message("[2/10] Reading configuration from file...")
config <- read_config_txt(config_path)
if (missing(genes_list_path))    genes_list_path    <- config$genes_list_path
if (missing(species_prefix))     species_prefix     <- config$species_prefix
if (missing(go_type))            go_type            <- config$go_type
if (missing(output_folder_path)) output_folder_path <- config$output_folder_path
if (missing(connection_type))    connection_type    <- config$connection_type
if (missing(level_from))         level_from         <- config$level_from
if (missing(level_to))           level_to           <- config$level_to
if (missing(label_type))         label_type         <- config$label_type
if (missing(layout_name))        layout_name        <- config$layout
if (missing(threshold))          threshold          <- config$threshold
if (is.null(config_evidence_path) || config_evidence_path == "") {
config_evidence_path <- default_evidence_experimental_only()
}
} else {
message("[2/10] Using provided arguments...")
}
go_file_path <- get_go_file_by_prefix(species_prefix, go_type)
message("[3/10] Logging parameters to output folder...")
log_lines <- c(
sprintf("   Species: %s", species_prefix),
sprintf("   GO file path: %s", go_file_path),
sprintf("   Genes list path: %s", genes_list_path),
sprintf("   Config evidence path: %s", config_evidence_path),
sprintf("   Output folder path: %s", normalizePath(output_folder_path, winslash = "/", mustWork = FALSE)),
sprintf("   Connection type: %s", connection_type),
sprintf("   GO level range: %s to %s", level_from, level_to),
sprintf("   Label type: %s", label_type),
sprintf("   Threshold weight: %s", threshold),
sprintf("   Layout option: %s", layout_name)
)
log_file <- file.path(output_folder_path, "log_parameters.txt")
writeLines(log_lines, con = log_file)
message("[4/10] Reading gene list...")
gene_df <- prepare_genes(genes_list_path, species_prefix, output_folder_path)
print(gene_df)
message("[5/10] Reading GO annotation file...")
go_df <- read_go_annotations(go_file_path, species_prefix)
print(go_df)
message("[6/10] Annotating genes with GO terms...")
annotated_genes <- annotate_with_go_terms(gene_df, go_df, output_folder_path, species_prefix)
print(annotated_genes)
message("[7/10] Checking annotation coverage...")
coverage_stats <- check_annotation_coverage(
annotated_genes = annotated_genes,
genes_list = unique(gene_df$ENSEMBL),
output_path = file.path(output_folder_path, "term_gene_table_not_mapped.txt")
)
print(annotated_genes)
print(unique(gene_df$ENSEMBL))
message(sprintf("Total genes: %d, Unmapped genes: %d", coverage_stats$total, coverage_stats$unmapped))
if (coverage_stats$unmapped >= coverage_stats$total - 1) {
stop(sprintf(
error_messages$all_genes_unmapped,
coverage_stats$total, coverage_stats$unmapped
))
}
